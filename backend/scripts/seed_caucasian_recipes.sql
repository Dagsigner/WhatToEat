-- Seed: 5 кавказских рецептов
-- Запуск: psql -U <user> -d <db> -f seed_caucasian_recipes.sql

BEGIN;

-- ============================================================
-- 1. Категория
-- ============================================================
INSERT INTO categories (id, title, slug, is_active, created_at, updated_at)
VALUES (
  'a0000000-0000-4000-8000-000000000001',
  'Кавказская кухня',
  'kavkazskaya-kukhnya',
  true, now(), now()
)
ON CONFLICT (title) DO NOTHING;

-- ============================================================
-- 2. Ингредиенты (ON CONFLICT — не дублируем если уже есть)
-- ============================================================
INSERT INTO ingredients (id, title, unit_of_measurement, slug, is_active, created_at, updated_at) VALUES
  ('b0000000-0000-4000-8000-000000000001', 'Мука пшеничная',       'g',   'muka-pshenichnaya',       true, now(), now()),
  ('b0000000-0000-4000-8000-000000000002', 'Говядина',             'g',   'govyadina',               true, now(), now()),
  ('b0000000-0000-4000-8000-000000000003', 'Баранина',             'g',   'baranina',                true, now(), now()),
  ('b0000000-0000-4000-8000-000000000004', 'Лук репчатый',         'pcs', 'luk-repchatyy',           true, now(), now()),
  ('b0000000-0000-4000-8000-000000000005', 'Кинза свежая',         'g',   'kinza-svezhaya',          true, now(), now()),
  ('b0000000-0000-4000-8000-000000000006', 'Зира',                 'g',   'zira',                    true, now(), now()),
  ('b0000000-0000-4000-8000-000000000007', 'Соль',                 'g',   'sol',                     true, now(), now()),
  ('b0000000-0000-4000-8000-000000000008', 'Перец чёрный молотый', 'g',   'perets-chyornyy-molotyy', true, now(), now()),
  ('b0000000-0000-4000-8000-000000000009', 'Вода',                 'ml',  'voda',                    true, now(), now()),
  ('b0000000-0000-4000-8000-000000000010', 'Лимон',                'pcs', 'limon',                   true, now(), now()),
  ('b0000000-0000-4000-8000-000000000011', 'Паприка',              'g',   'paprika',                 true, now(), now()),
  ('b0000000-0000-4000-8000-000000000012', 'Сулугуни',             'g',   'suluguni',                true, now(), now()),
  ('b0000000-0000-4000-8000-000000000013', 'Брынза',               'g',   'brynza',                  true, now(), now()),
  ('b0000000-0000-4000-8000-000000000014', 'Яйцо куриное',        'pcs', 'yaytso-kurinoe',          true, now(), now()),
  ('b0000000-0000-4000-8000-000000000015', 'Масло сливочное',      'g',   'maslo-slivochnoe',        true, now(), now()),
  ('b0000000-0000-4000-8000-000000000016', 'Молоко',               'ml',  'moloko',                  true, now(), now()),
  ('b0000000-0000-4000-8000-000000000017', 'Дрожжи сухие',         'g',   'drozhzhi-sukhie',         true, now(), now()),
  ('b0000000-0000-4000-8000-000000000018', 'Сахар',                'g',   'sakhar',                  true, now(), now()),
  ('b0000000-0000-4000-8000-000000000019', 'Курдючный жир',        'g',   'kurdyuchnyy-zhir',        true, now(), now()),
  ('b0000000-0000-4000-8000-000000000020', 'Кориандр молотый',     'g',   'koriandr-molotyy',        true, now(), now()),
  ('b0000000-0000-4000-8000-000000000021', 'Виноградные листья',   'pcs', 'vinogradnye-listya',      true, now(), now()),
  ('b0000000-0000-4000-8000-000000000022', 'Рис круглозёрный',     'g',   'ris-kruglozyornyy',       true, now(), now()),
  ('b0000000-0000-4000-8000-000000000023', 'Мята свежая',          'g',   'myata-svezhaya',          true, now(), now()),
  ('b0000000-0000-4000-8000-000000000024', 'Базилик свежий',       'g',   'bazilik-svezhiy',         true, now(), now()),
  ('b0000000-0000-4000-8000-000000000025', 'Мацони',               'ml',  'matsoni',                 true, now(), now()),
  ('b0000000-0000-4000-8000-000000000026', 'Чеснок',               'pcs', 'chesnok',                 true, now(), now()),
  ('b0000000-0000-4000-8000-000000000027', 'Баранина (корейка)',    'g',   'baranina-koreyka',        true, now(), now())
ON CONFLICT (title) DO NOTHING;

-- ============================================================
-- 3. Рецепты
-- ============================================================

-- 3.1 Хинкали
INSERT INTO recipes (id, title, slug, photo_url, description, protein, fat, carbs, prep_time, cook_time, difficulty, servings, is_active, created_at, updated_at)
VALUES (
  'c0000000-0000-4000-8000-000000000001',
  'Хинкали',
  'khinkali',
  '',
  'Традиционные грузинские пельмени с сочной мясной начинкой, приправленные зирой и кинзой. Тесто тонко раскатывается, а при лепке формируются характерные складки. Едят руками, надкусывая и выпивая бульон.',
  18.0, 12.0, 30.0,
  40, 15, 'medium', '4 порции', true, now(), now()
);

-- 3.2 Шашлык из баранины
INSERT INTO recipes (id, title, slug, photo_url, description, protein, fat, carbs, prep_time, cook_time, difficulty, servings, is_active, created_at, updated_at)
VALUES (
  'c0000000-0000-4000-8000-000000000002',
  'Шашлык из баранины',
  'shashlyk-iz-baraniny',
  '',
  'Классический кавказский шашлык из баранины, маринованной с луком и специями. Мясо нарезается крупными кусками и жарится на углях до румяной корочки с сочной серединкой. Подаётся с маринованным луком и свежей зеленью.',
  25.0, 20.0, 3.0,
  30, 20, 'easy', '6 порций', true, now(), now()
);

-- 3.3 Хачапури по-аджарски
INSERT INTO recipes (id, title, slug, photo_url, description, protein, fat, carbs, prep_time, cook_time, difficulty, servings, is_active, created_at, updated_at)
VALUES (
  'c0000000-0000-4000-8000-000000000003',
  'Хачапури по-аджарски',
  'khachapuri-po-adzharsky',
  '',
  'Открытая грузинская лепёшка в форме лодочки с расплавленным сыром сулугуни и яйцом в центре. Перед подачей добавляется кусочек сливочного масла. Тесто хрустящее снаружи и мягкое внутри.',
  22.0, 28.0, 45.0,
  30, 20, 'medium', '2 порции', true, now(), now()
);

-- 3.4 Люля-кебаб
INSERT INTO recipes (id, title, slug, photo_url, description, protein, fat, carbs, prep_time, cook_time, difficulty, servings, is_active, created_at, updated_at)
VALUES (
  'c0000000-0000-4000-8000-000000000004',
  'Люля-кебаб',
  'lyulya-kebab',
  '',
  'Кебаб из рубленого мяса баранины и говядины со специями, сформированный на шампурах и обжаренный на мангале. Мясо получается сочным за счёт курдючного жира. Подаётся с лавашом, маринованным луком и сумахом.',
  22.0, 18.0, 2.0,
  40, 15, 'hard', '4 порции', true, now(), now()
);

-- 3.5 Долма
INSERT INTO recipes (id, title, slug, photo_url, description, protein, fat, carbs, prep_time, cook_time, difficulty, servings, is_active, created_at, updated_at)
VALUES (
  'c0000000-0000-4000-8000-000000000005',
  'Долма',
  'dolma',
  '',
  'Голубцы в виноградных листьях с начинкой из бараньего фарша, риса и ароматных трав. Тушатся в бульоне до мягкости. Подаются с соусом из мацони с чесноком — традиционное блюдо кавказской кухни.',
  15.0, 14.0, 18.0,
  45, 50, 'medium', '4 порции', true, now(), now()
);

-- ============================================================
-- 4. Связь рецептов с категорией
-- ============================================================
INSERT INTO recipe_categories (id, recipe_id, category_id) VALUES
  ('d0000000-0000-4000-8000-000000000001', 'c0000000-0000-4000-8000-000000000001', 'a0000000-0000-4000-8000-000000000001'),
  ('d0000000-0000-4000-8000-000000000002', 'c0000000-0000-4000-8000-000000000002', 'a0000000-0000-4000-8000-000000000001'),
  ('d0000000-0000-4000-8000-000000000003', 'c0000000-0000-4000-8000-000000000003', 'a0000000-0000-4000-8000-000000000001'),
  ('d0000000-0000-4000-8000-000000000004', 'c0000000-0000-4000-8000-000000000004', 'a0000000-0000-4000-8000-000000000001'),
  ('d0000000-0000-4000-8000-000000000005', 'c0000000-0000-4000-8000-000000000005', 'a0000000-0000-4000-8000-000000000001');

-- ============================================================
-- 5. Связь рецептов с ингредиентами
-- ============================================================

-- Хинкали
INSERT INTO recipe_ingredients (id, recipe_id, ingredient_id, amount, created_at, updated_at) VALUES
  ('e0000000-0000-4000-8000-000000000001', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000001', 500,   now(), now()),
  ('e0000000-0000-4000-8000-000000000002', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000002', 300,   now(), now()),
  ('e0000000-0000-4000-8000-000000000003', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000003', 200,   now(), now()),
  ('e0000000-0000-4000-8000-000000000004', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000004', 2,     now(), now()),
  ('e0000000-0000-4000-8000-000000000005', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000005', 30,    now(), now()),
  ('e0000000-0000-4000-8000-000000000006', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000006', 5,     now(), now()),
  ('e0000000-0000-4000-8000-000000000007', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000007', 10,    now(), now()),
  ('e0000000-0000-4000-8000-000000000008', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000008', 3,     now(), now()),
  ('e0000000-0000-4000-8000-000000000009', 'c0000000-0000-4000-8000-000000000001', 'b0000000-0000-4000-8000-000000000009', 250,   now(), now());

-- Шашлык из баранины
INSERT INTO recipe_ingredients (id, recipe_id, ingredient_id, amount, created_at, updated_at) VALUES
  ('e0000000-0000-4000-8000-000000000010', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000027', 1500,  now(), now()),
  ('e0000000-0000-4000-8000-000000000011', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000004', 4,     now(), now()),
  ('e0000000-0000-4000-8000-000000000012', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000010', 1,     now(), now()),
  ('e0000000-0000-4000-8000-000000000013', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000005', 40,    now(), now()),
  ('e0000000-0000-4000-8000-000000000014', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000006', 5,     now(), now()),
  ('e0000000-0000-4000-8000-000000000015', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000011', 5,     now(), now()),
  ('e0000000-0000-4000-8000-000000000016', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000007', 15,    now(), now()),
  ('e0000000-0000-4000-8000-000000000017', 'c0000000-0000-4000-8000-000000000002', 'b0000000-0000-4000-8000-000000000008', 5,     now(), now());

-- Хачапури по-аджарски
INSERT INTO recipe_ingredients (id, recipe_id, ingredient_id, amount, created_at, updated_at) VALUES
  ('e0000000-0000-4000-8000-000000000018', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000001', 400,   now(), now()),
  ('e0000000-0000-4000-8000-000000000019', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000012', 300,   now(), now()),
  ('e0000000-0000-4000-8000-000000000020', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000013', 100,   now(), now()),
  ('e0000000-0000-4000-8000-000000000021', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000014', 3,     now(), now()),
  ('e0000000-0000-4000-8000-000000000022', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000015', 50,    now(), now()),
  ('e0000000-0000-4000-8000-000000000023', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000016', 150,   now(), now()),
  ('e0000000-0000-4000-8000-000000000024', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000017', 7,     now(), now()),
  ('e0000000-0000-4000-8000-000000000025', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000018', 10,    now(), now()),
  ('e0000000-0000-4000-8000-000000000026', 'c0000000-0000-4000-8000-000000000003', 'b0000000-0000-4000-8000-000000000007', 5,     now(), now());

-- Люля-кебаб
INSERT INTO recipe_ingredients (id, recipe_id, ingredient_id, amount, created_at, updated_at) VALUES
  ('e0000000-0000-4000-8000-000000000027', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000003', 400,   now(), now()),
  ('e0000000-0000-4000-8000-000000000028', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000002', 300,   now(), now()),
  ('e0000000-0000-4000-8000-000000000029', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000019', 100,   now(), now()),
  ('e0000000-0000-4000-8000-000000000030', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000004', 2,     now(), now()),
  ('e0000000-0000-4000-8000-000000000031', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000005', 20,    now(), now()),
  ('e0000000-0000-4000-8000-000000000032', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000006', 5,     now(), now()),
  ('e0000000-0000-4000-8000-000000000033', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000020', 3,     now(), now()),
  ('e0000000-0000-4000-8000-000000000034', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000007', 10,    now(), now()),
  ('e0000000-0000-4000-8000-000000000035', 'c0000000-0000-4000-8000-000000000004', 'b0000000-0000-4000-8000-000000000008', 3,     now(), now());

-- Долма
INSERT INTO recipe_ingredients (id, recipe_id, ingredient_id, amount, created_at, updated_at) VALUES
  ('e0000000-0000-4000-8000-000000000036', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000021', 40,    now(), now()),
  ('e0000000-0000-4000-8000-000000000037', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000003', 500,   now(), now()),
  ('e0000000-0000-4000-8000-000000000038', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000022', 100,   now(), now()),
  ('e0000000-0000-4000-8000-000000000039', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000004', 2,     now(), now()),
  ('e0000000-0000-4000-8000-000000000040', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000023', 15,    now(), now()),
  ('e0000000-0000-4000-8000-000000000041', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000005', 20,    now(), now()),
  ('e0000000-0000-4000-8000-000000000042', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000024', 10,    now(), now()),
  ('e0000000-0000-4000-8000-000000000043', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000025', 200,   now(), now()),
  ('e0000000-0000-4000-8000-000000000044', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000026', 3,     now(), now()),
  ('e0000000-0000-4000-8000-000000000045', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000007', 10,    now(), now()),
  ('e0000000-0000-4000-8000-000000000046', 'c0000000-0000-4000-8000-000000000005', 'b0000000-0000-4000-8000-000000000008', 3,     now(), now());

-- ============================================================
-- 6. Шаги приготовления
-- ============================================================

-- Хинкали
INSERT INTO steps (id, recipe_id, step_number, title, description, photo_url, is_active, created_at, updated_at) VALUES
  ('f0000000-0000-4000-8000-000000000001', 'c0000000-0000-4000-8000-000000000001', 1, 'Замесить тесто',        'Смешать муку с солью и водой, вымесить эластичное тесто. Накрыть плёнкой и оставить на 30 минут.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000002', 'c0000000-0000-4000-8000-000000000001', 2, 'Приготовить начинку',    'Мясо пропустить через мясорубку с крупной решёткой. Добавить мелко нарезанный лук, кинзу, зиру, соль, перец и немного воды. Хорошо вымешать.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000003', 'c0000000-0000-4000-8000-000000000001', 3, 'Раскатать и слепить',    'Тесто разделить на части, раскатать тонкие круги. В центр положить начинку, собрать складки, защипнуть хвостик.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000004', 'c0000000-0000-4000-8000-000000000001', 4, 'Отварить',               'В кипящую подсоленную воду аккуратно опустить хинкали. Варить 12–15 минут после всплытия.', NULL, true, now(), now());

-- Шашлык из баранины
INSERT INTO steps (id, recipe_id, step_number, title, description, photo_url, is_active, created_at, updated_at) VALUES
  ('f0000000-0000-4000-8000-000000000005', 'c0000000-0000-4000-8000-000000000002', 1, 'Нарезать мясо',         'Баранину нарезать кусками 4×4 см, удалить плёнки.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000006', 'c0000000-0000-4000-8000-000000000002', 2, 'Замариновать',           'Лук нарезать кольцами, помять руками. Смешать мясо с луком, специями и лимонным соком. Мариновать 4–6 часов в холодильнике.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000007', 'c0000000-0000-4000-8000-000000000002', 3, 'Нанизать на шампуры',    'Мясо нанизать на шампуры, чередуя с кольцами лука.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000008', 'c0000000-0000-4000-8000-000000000002', 4, 'Жарить на углях',        'Жарить на раскалённых углях 15–20 минут, периодически переворачивая.', NULL, true, now(), now());

-- Хачапури по-аджарски
INSERT INTO steps (id, recipe_id, step_number, title, description, photo_url, is_active, created_at, updated_at) VALUES
  ('f0000000-0000-4000-8000-000000000009', 'c0000000-0000-4000-8000-000000000003', 1, 'Приготовить тесто',      'Дрожжи развести в тёплом молоке с сахаром. Смешать с мукой, солью и 1 яйцом. Вымесить, оставить подходить на 1 час.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000010', 'c0000000-0000-4000-8000-000000000003', 2, 'Подготовить начинку',    'Сулугуни и брынзу натереть на крупной тёрке, смешать с 1 яйцом.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000011', 'c0000000-0000-4000-8000-000000000003', 3, 'Сформировать лодочки',   'Тесто разделить на 2 части, раскатать овалы. Края завернуть валиком, сформировать лодочку. Выложить начинку.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000012', 'c0000000-0000-4000-8000-000000000003', 4, 'Выпекать',               'Выпекать при 230°C 15–18 минут. Достать, сделать углубление, вбить по яйцу и положить масло. Вернуть в духовку на 2 минуты.', NULL, true, now(), now());

-- Люля-кебаб
INSERT INTO steps (id, recipe_id, step_number, title, description, photo_url, is_active, created_at, updated_at) VALUES
  ('f0000000-0000-4000-8000-000000000013', 'c0000000-0000-4000-8000-000000000004', 1, 'Подготовить фарш',      'Мясо и курдючный жир мелко порубить ножом (не через мясорубку). Лук очень мелко нарезать.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000014', 'c0000000-0000-4000-8000-000000000004', 2, 'Вымесить массу',        'Смешать мясо с луком, кинзой и специями. Долго вымешивать и отбивать, чтобы масса стала вязкой и держала форму.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000015', 'c0000000-0000-4000-8000-000000000004', 3, 'Охладить',              'Убрать фарш в холодильник на 1–2 часа.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000016', 'c0000000-0000-4000-8000-000000000004', 4, 'Сформировать на шампурах', 'Мокрыми руками формировать колбаски вокруг шампуров длиной 15–20 см.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000017', 'c0000000-0000-4000-8000-000000000004', 5, 'Жарить',                'На раскалённых углях жарить 10–15 минут, часто переворачивая.', NULL, true, now(), now());

-- Долма
INSERT INTO steps (id, recipe_id, step_number, title, description, photo_url, is_active, created_at, updated_at) VALUES
  ('f0000000-0000-4000-8000-000000000018', 'c0000000-0000-4000-8000-000000000005', 1, 'Подготовить листья',     'Виноградные листья промыть и бланшировать в кипятке 2–3 минуты. Обрезать черенки.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000019', 'c0000000-0000-4000-8000-000000000005', 2, 'Приготовить начинку',    'Фарш смешать с промытым рисом, мелко нарезанным луком, рубленой зеленью, солью и перцем.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000020', 'c0000000-0000-4000-8000-000000000005', 3, 'Завернуть долму',        'На матовую сторону листа положить столовую ложку начинки, завернуть конвертом.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000021', 'c0000000-0000-4000-8000-000000000005', 4, 'Тушить',                'Плотно уложить в кастрюлю швом вниз, придавить тарелкой. Залить бульоном или водой вровень. Тушить на слабом огне 45–50 минут.', NULL, true, now(), now()),
  ('f0000000-0000-4000-8000-000000000022', 'c0000000-0000-4000-8000-000000000005', 5, 'Приготовить соус',       'Мацони смешать с давленым чесноком и солью. Подавать долму горячей с соусом.', NULL, true, now(), now());

COMMIT;
